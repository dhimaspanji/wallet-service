CREATE TABLE ACCOUNT (
    ID VARCHAR(36) PRIMARY KEY,
    BALANCE NUMERIC(19,2) NOT NULL DEFAULT 0,
    VERSION BIGINT NOT NULL DEFAULT 0,
    CREATED_BY VARCHAR(36),
    CREATED_TIME TIMESTAMP WITH TIME ZONE,
    UPDATED_BY VARCHAR(36),
    UPDATED_TIME TIMESTAMP WITH TIME ZONE
);

CREATE TABLE TRANSACTION (
    ID VARCHAR(36) PRIMARY KEY,
    REFERENCE_NO VARCHAR(100) NOT NULL,
    REQUEST_ID VARCHAR(150) NOT NULL,
    CHANNEL VARCHAR(20) NOT NULL,
    ACCOUNT_ID VARCHAR(36),
    TYPE VARCHAR(20),
    AMOUNT NUMERIC(19,2),
    STATUS VARCHAR(20),
    VERSION BIGINT NOT NULL DEFAULT 0,
    CREATED_BY VARCHAR(36),
    CREATED_TIME TIMESTAMP WITH TIME ZONE,
    UPDATED_BY VARCHAR(36),
    UPDATED_TIME TIMESTAMP WITH TIME ZONE,

    CONSTRAINT UK_REFERENCE_NO
     UNIQUE (REFERENCE_NO),

    CONSTRAINT UK_REQUEST_CHANNEL_PARTNER
     UNIQUE (REQUEST_ID, CHANNEL)
);

CREATE TABLE ACCOUNT_MUTATION (
    ID VARCHAR(36) PRIMARY KEY,
    TRANSACTION_ID VARCHAR(36),
    ACCOUNT_ID VARCHAR(36),
    ENTRY_TYPE VARCHAR(10),
    AMOUNT NUMERIC(19,2),
    BALANCE_BEFORE NUMERIC(19,2),
    BALANCE_AFTER NUMERIC(19,2),
    CREATED_BY VARCHAR(36),
    CREATED_TIME TIMESTAMP WITH TIME ZONE
);
